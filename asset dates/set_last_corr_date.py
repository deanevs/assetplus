"""
Format required :-
Date from encours.job_end = '2021-01-13'

D_DERN_INT = '2021-01-13'   # date of last wo i.e. same
D_DER_I_C = '2021-01-13'    # date of last corrective i.e. same
D_DER_I_P = '2021-01-13'    # date of last PM
D_PRO_I_P = '20200318'      # date of next PM

"""
import datetime

def main():

    # d = '15-01-2021'
    # d1 = str_to_date(d)
    # d2 = d1 + datetime.timedelta(days=365)
    # print(d2)


    n = len(assets)
    idx = 0
    for idx in range(n):
        sql = update_last_corr_eq1996(assets[idx][0], (assets[idx][1]))
        print(sql)
        print("GO")



def convert_date(d):
    day = d[:2]
    month= d[3:5]
    year = d[6:10]
    return year + '-' + month + '-' + day
#
# def update_last_pm_eq1996(asset, pm_date):
#     # This needs to be set to the date of the last visit of the PM
#     # plus calculate the next PM date to 1 year
#     # last_wo = pm_date      # set this as pm date
#
#     dt_pm_date = str_to_date(pm_date)
#
#     str_pm_date = date_to_str_last(dt_pm_date)
#     dt_next_pm = dt_pm_date + datetime.timedelta(days=365)
#     str_next_pm = date_to_str_next(dt_next_pm)
#
#     sql = "UPDATE B_EQ1996\n" \
#           f"SET D_DER_I_P = '{str_pm_date}', D_PRO_I_P = '{str_next_pm}' WHERE N_IMMA = '{asset}'\n"
#
#     return sql

def update_last_corr_eq1996(asset,date_in):
    date_last_wo = date_in
    sql = "UPDATE B_EQ1996\n" \
          f"SET D_DER_I_C = '{convert_date(date_last_wo)}' WHERE N_IMMA = '{asset}'"
    return sql


# def str_to_date(date_string):
#     """Helper function for converting string to date"""
#     return datetime.datetime.strptime(date_string, '%d-%m-%Y').date()
#
# def date_to_str_last(date):
#     """Helper function for converting date to string"""
#     return date.strftime("%Y-%m-%d")
#
# def date_to_str_next(date):
#     """Helper function for converting date to string"""
#     return date.strftime("%Y%m%d")

assets = [('AP-28301','07-05-2021'),
('513793','09-03-2010'),
('507563','13-01-2011'),
('526801','20-04-2016'),
('539636','17-10-2011'),
('511285','13-06-2014'),
('510259','21-02-2017'),
('RMF08038696PA','05-04-2017'),
('507545','01-05-2017'),
('507545','01-05-2017'),
('507545','31-07-2017'),
('532040','25-09-2017'),
('534137','03-10-2017'),
('534346','03-10-2017'),
('525316','06-11-2017'),
('511541','02-02-2018'),
('506099','02-07-2018'),
('505295','27-09-2018'),
('511275','31-10-2018'),
('516764','07-01-2019'),
('507547','02-02-2019'),
('506466','05-03-2019'),
('504377','02-04-2019'),
('504408','09-04-2019'),
('504377','08-05-2019'),
('526507','01-06-2019'),
('514796','01-06-2019'),
('513789','02-06-2019'),
('513272','11-06-2019'),
('513789','17-07-2019'),
('AP-16892','20-09-2019'),
('503477','26-09-2019'),
('512835','14-11-2019'),
('506743','03-12-2019'),
('503184','09-12-2019'),
('500247','17-12-2019'),
('530187','16-01-2020'),
('529239','16-01-2020'),
('501838','27-02-2020'),
('501838','27-02-2020'),
('507093','28-02-2020'),
('507093','28-02-2020'),
('515762','28-02-2020'),
('AP-18101','05-03-2020'),
('500619','01-03-2020'),
('522168','01-03-2020'),
('504762','09-03-2020'),
('510657','01-04-2020'),
('531458','01-04-2020'),
('63194','01-04-2020'),
('514703','01-04-2020'),
('514819','01-04-2020'),
('506081','01-04-2020'),
('510657','07-04-2020'),
('511536','08-04-2020'),
('514721','13-05-2020'),
('507369','22-05-2020'),
('543535','21-05-2020'),
('507369','28-05-2020'),
('500619','05-06-2020'),
('514703','08-06-2020'),
('512529','22-06-2020'),
('507437','19-06-2020'),
('522693','22-06-2020'),
('505258','23-06-2020'),
('525372','29-06-2020'),
('530623','02-07-2020'),
('527359','01-08-2020'),
('55843','02-07-2020'),
('521956','03-07-2020'),
('543549','10-07-2020'),
('205746','13-08-2020'),
('516433','25-08-2020'),
('507358','26-08-2020'),
('504803','02-09-2020'),
('504803','02-09-2020'),
('515425','03-09-2020'),
('510281','17-09-2020'),
('AP-19589','17-09-2020'),
('510952','17-09-2020'),
('521956','07-10-2020'),
('510734','13-10-2020'),
('506960','14-10-2020'),
('509072','20-10-2020'),
('501384','02-11-2020'),
('500931','29-08-2018'),
('525421','16-11-2020'),
('525421','16-11-2020'),
('500206','18-11-2020'),
('500206','18-11-2020'),
('500206','18-11-2020'),
('500206','18-11-2020'),
('512427','19-11-2020'),
('539363','16-11-2020'),
('55717','19-11-2020'),
('510416','24-11-2020'),
('534917','24-11-2020'),
('AP-19582','24-11-2020'),
('501554','26-11-2020'),
('501840','07-12-2020'),
('506092','04-12-2020'),
('527359','01-02-2021'),
('514132','06-01-2021'),
('512492','08-01-2021'),
('539367','08-01-2021'),
('510736','13-01-2021'),
('520692','21-01-2021'),
('520692','21-01-2021'),
('520693','21-01-2021'),
('520693','21-01-2021'),
('507181','16-01-2021'),
('507181','22-01-2021'),
('505233','22-01-2021'),
('501627','27-01-2021'),
('501627','27-01-2021'),
('AP-19252','01-04-2021'),
('515924','01-02-2021'),
('508564','02-03-2021'),
('505470','04-02-2021'),
('AP-16681','09-02-2021'),
('509813','02-03-2021'),
('530760','22-02-2021'),
('500254','24-02-2021'),
('510736','01-03-2021'),
('506332','05-03-2021'),
('501625','11-03-2021'),
('105029','18-03-2021'),
('AP-27251','01-06-2021'),
('516911','04-02-2014'),
('512647','30-03-2021'),
('508563','30-03-2021'),
('525173','11-06-2021'),
('511459','22-04-2021'),
('510737','29-04-2021'),
('510737','29-04-2021'),
('513104','12-04-2021'),
('510829','14-04-2021'),
('504482','16-04-2021'),
('522373','26-04-2021'),
('540771','17-05-2021'),
('509813','17-05-2021'),
('504864','23-06-2021'),
('513502','12-05-2021'),
('512985','10-12-2003'),
('506880','26-02-2008'),
('516595','28-05-2008'),
('506437','01-12-2008'),
('501658','15-10-2009'),
('513790','26-07-2010'),
('520487','26-07-2010'),
('534502','26-07-2010'),
('501119','15-04-2011'),
('510751','03-06-2011'),
('517577','10-06-2011'),
('506185','17-10-2011'),
('522449','08-06-2012'),
('534079','16-06-2012'),
('513454','16-06-2012'),
('531734','23-06-2012'),
('516432','23-06-2012'),
('512467','17-07-2012'),
('512466','17-07-2012'),
('511859','19-07-2012'),
('511859','19-07-2012'),
('510359','28-09-2012'),
('512986','28-09-2012'),
('201494','28-09-2012'),
('201503','28-09-2012'),
('505305','28-09-2012'),
('506889','05-11-2012'),
('506041','09-04-2013'),
('500127','09-04-2013'),
('527550','19-04-2013'),
('201714','19-04-2013'),
('520280','19-04-2013'),
('520403','23-04-2013'),
('520180','23-04-2013'),
('520171','23-04-2013'),
('520270','23-04-2013'),
('527554','23-04-2013'),
('527555','23-04-2013'),
('523242','23-04-2013'),
('201817','24-04-2013'),
('201822','24-04-2013'),
('527556','24-04-2013'),
('520181','24-04-2013'),
('520272','24-04-2013'),
('527552','05-07-2013'),
('201933','05-07-2013'),
('514823','09-09-2013'),
('501120','13-11-2013'),
('VH014507B3','18-02-2014'),
('200646','19-05-2014'),
('507577','09-04-2015'),
('516412','23-04-2015'),
('56126','31-05-2016'),
('504717','20-08-2018'),
('515441','23-03-2020'),
('518482','07-09-2020'),
('AP-16900','20-10-2020'),
('539362','20-10-2020'),
('AP-22061','02-11-2020'),
('515174','10-11-2020'),
('AP-20611','13-11-2020'),
('506105','16-12-2020'),
('AP-22376','12-01-2021'),
('506333','18-01-2021'),
('515446','25-03-2021'),
('AP-22458','29-03-2021'),
('AP-22458','29-03-2021'),
('506380','31-03-2021'),
('514651','12-04-2021'),
('514651','12-04-2021'),
('510828','14-04-2021'),
('506534','16-04-2021'),
('509515','29-04-2021'),
('506453','29-04-2021'),
('506453','29-04-2021'),
('500563','30-04-2021'),
('506044','30-04-2021'),
('514892','30-04-2021'),
('AP-16956','30-04-2021'),
('534903','30-04-2021'),
('534909','30-04-2021'),
('534915','30-04-2021'),
('512493','30-04-2021'),
('503480','30-04-2021'),
('534912','30-04-2021'),
('534913','30-04-2021'),
('503482','30-04-2021'),
('534910','30-04-2021'),
('534911','30-04-2021'),
('543595','30-04-2021'),
('AP-27177','30-04-2021'),
('AP-23364','30-04-2021'),
('506108','30-04-2021'),
('506177','30-04-2021'),
('522940','07-05-2021'),
('514800','10-05-2021'),
('509047','13-05-2021'),
('515443','19-05-2021'),
('518034','19-05-2021'),
('540771','25-05-2021'),
('540772','25-05-2021'),
('540772','25-05-2021'),
('AP-21963','26-05-2021'),
('508564','27-05-2021'),
('505469','27-05-2021'),
('503167','02-06-2021'),
('515448','03-06-2021'),
('511942','08-06-2021'),
('529231','09-06-2021'),
('511465','10-06-2021'),
('AP-19272','18-06-2021'),
('520694','22-06-2021'),
('520694','22-06-2021'),
('506526','23-06-2021'),
('506535','30-06-2021'),
('530972','01-07-2021'),
('506523','05-07-2021'),
('504581','05-07-2021'),
('AP-22880','05-07-2021'),
('512753','05-07-2021'),
('513067','05-07-2021'),
('521736','08-07-2021'),
('501742','08-07-2021'),
('506464','08-07-2021'),
('553221','08-07-2021'),
('521735','08-07-2021'),
('106601','08-07-2021'),
('501573','09-07-2021'),
('515447','09-07-2021'),
('527338','09-07-2021'),
('506308','12-07-2021'),
('522375','12-07-2021'),
('514923','30-04-2021'),
('513544','30-04-2021'),
('506153','30-04-2021'),
('512483','15-06-2021'),
('522568','06-07-2021'),
('513535','28-05-2021'),
('515460','10-06-2021'),
('AP-16974','02-07-2021'),
('503473','02-07-2021'),
('511274','12-05-2021'),
('511196','16-06-2021')]

if __name__ == '__main__':
    main()